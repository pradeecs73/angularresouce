
<section data-ng-controller="SecuritytasksController"
	data-ng-init="fetchSecurityTasks();">
	<div class="row">
		<div class="col-sm-12">
			<div class="row">
				<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
					<a class="dashboard-stat dashboard-stat-v2 blue" href="#">
						<div class="visual">
							<i class="fa fa-comments"></i>
						</div>
						<div class="details">
							<div class="number">
								<span data-counter="counterup">{{tasks.securitytask.length}}</span>
							</div>
							<div class="desc">Total Security Tasks</div>
						</div>
					</a>
				</div>
				<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
					<a class="dashboard-stat dashboard-stat-v2 blue" href="#">
						<div class="visual">
							<i class="fa fa-comments"></i>
						</div>
						<div class="details">
							<div class="number">
								<span data-counter="counterup">{{tasks.totalhours}}</span>
							</div>
							<div class="desc">Total Hours</div>
						</div>
					</a>
				</div>
				<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
					<a class="dashboard-stat dashboard-stat-v2 blue" href="#">
						<div class="visual">
							<i class="fa fa-comments"></i>
						</div>
						<div class="details">
							<div class="number">
								<span data-counter="counterup">{{tasks.externaltask.length}}</span>
							</div>
							<div class="desc">Total External tasks</div>
						</div>
					</a>
				</div>
				<div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
					<a class="dashboard-stat dashboard-stat-v2 blue" href="#">
						<div class="visual">
							<i class="fa fa-comments"></i>
						</div>
						<div class="details">
							<div class="number">
								<span data-counter="counterup">{{tasks.totalcost}} SEK</span>
							</div>
							<div class="desc">Total Cost</div>
						</div>
					</a>
				</div>

			</div>
			<div class="portlet light bordered  clearfix">

				<div class="portlet-title">
					<div class="caption">
						<i class=" icon-layers font-black"></i> <span
							class="caption-subject font-black bold uppercase">Security
							Task</span>
					</div>
				</div>

				<div class="portlet-body scrollx">
					<div class="table-responsive ">
						<div class="taskTable" ng-repeat="task in tasks.securitytask">
							<div class="taskName clearfix">
								<table class="table table-striped table-bordered table-hover font-green taskNameTable">
									<thead>
										<tr>
											<th class="uppercase">{{task.task_name}}</th>
											<th>Total Hours: {{task.totalActualHour}}</th>
											<th>Total Cost: {{task.totalActualCost}}</th>
											<th>Responsible: {{task.responsible_action.username}}</th>
											<th>Completed At: {{task.completedAt | date:'mediumDate'}}</th>
										</tr>
									</thead>
								</table>
								<div class="subtaskName col-md-12"  data-ng-repeat="subtasks in task.subtask">
									<h4>{{subtasks.name}}</h4>	
									<div class="row">
										<div class="col-sm-12 col-md-6">
										<span data-ng-if="!subtasks.loghours.length">No Hours Logged</span>
										<div data-ng-if="subtasks.loghours.length"> LogHour Table</div>
										<table class="table table-striped table-bordered table-hover" data-ng-if="subtasks.loghours.length">
											<thead>
												<tr>
													<th>Performed By</th>
													<th>Date</th>
													<th>Actual Hours</th>
												</tr>
											</thead>
											<tbody>
												<tr data-ng-repeat="data in subtasks.loghours">
													<td>
													{{data.person.username}}</td>
													<td>{{data.updatedAt | date:'mediumDate'}}</td>
													<td>
													{{data.actual_time}}</td>
												</tr>
											</tbody>
										</table>
										</div>
										<div class="col-sm-12 col-md-6">
										<span data-ng-if="!subtasks.cost.length">No Cost</span>
										<div data-ng-if="subtasks.cost.length"> Cost Table</div>
											<table class="table table-striped table-bordered table-hover" data-ng-if="subtasks.cost.length">
												<thead>
													<tr>
														<th>Actual Cost</th>
													</tr>
												</thead>
												<tbody>
													<tr data-ng-repeat="costobj in subtasks.cost">
														<td>
														{{costobj.actual_cost}}</td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
									<hr>
								</div>
						</div>	
						</div>
					</div>
				</div>
			</div>

			<div class="portlet light bordered  clearfix">

				<div class="portlet-title">
					<div class="caption">
						<i class=" icon-layers font-black"></i> <span
							class="caption-subject font-black bold uppercase">External
							Security Task </span>
					</div>
				</div>

				<div class="portlet-body scrollx">
					<div class="table-responsive">
						<table class="table table-striped table-bordered table-hover">
							<thead>
								<tr>
								    <th>External Task</th>
									<th>Actual Hours</th>
									<th>Cost</th>
								</tr>
							</thead>
							<tbody>
								<tr data-ng-repeat="externaltask in tasks.externaltask">
								    <td>{{externaltask.task_name}}</td>
									<td>{{externaltask.actual_hours}}</td>
									<td>{{externaltask.actual_cost}}</td>
								</tr>
							</tbody>
						</table>

					</div>
				</div>
			</div>


		</div>
	</div>
</section>
